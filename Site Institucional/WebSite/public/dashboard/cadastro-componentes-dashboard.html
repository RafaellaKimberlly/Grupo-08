<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="../funcoes.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;400&family=Roboto:wght@300;400;500;900&display=swap"
        rel="stylesheet">
    <link rel="shortcut icon" href="../img/2.png" type="image/x-icon">
    <link rel="stylesheet" href="../css/cadastro-componentes-dashboard.css">
    <title>Cadastro de Componentes</title>
</head>

<body>
    <input type="checkbox" id="menu-toggle">
    <div class="sidebar">
        <div class="sidebar-marca">
            <label for="menu-toggle">
                <div class="menu-hamburguer">
                    <div class="line1"></div>
                    <div class="line2"></div>
                    <div class="line3"></div>
                </div>
            </label>
        </div>
        <div class="sidebar-menu">
            <ul>
                <li>
                    <a href="dashboard-home.html"><i class="fas fa-home"></i><span>Home</span></a>
                </li>
                <li>
                    <a href="dashboard-relatorios.html"><i class="fas fa-clipboard-list"></i><span>Relatório</span></a>
                </li>
                <li>
                    <a class="active" href="cadastro-componentes-dashboard.html"><i
                            class="fas fa-desktop"></i></i><span>Cadastro Componentes</span></a>
                </li>
                <li>
                    <a href="dashboard-perfil.html"><i class="fas fa-user-circle"></i><span>Perfil</span></a>
                </li>
            </ul>
        </div>
        <div class="sidebar-menu sair">
            <ul>
                <li>
                    <a href="../login-cadastro.html">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Encerrar sessão</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="header-dashboard">
        <header>
            <!-- <div class="search-wrapper">
                <span class="icone-pesquisa"><img src="../img/icone pesquisa.png" alt=""></span>
                <input type="search" placeholder="Search here">
            </div> -->
            <div class="user-wrapper">
                <img src="../img/foto-perfil.png" width="40px" height="40px" alt="">
                <div>
                    <h4 id="h4_nome">Olá </h4>
                    <b id="b_usuario"></b>
                    <small>Usuario comum</small>
                </div>
            </div>
        </header>

        <main>
            <div class="formulario">

                <form id="form_cadastro_maquina" method="POST" onsubmit="return cadastrar_maquina()">

                    <h2>Cadastro de Máquinas e Componentes</h2> <br>

                    <!-- <label for="">
                        ID da Máquina:
                        <input class="ipt-form" type="text" name="id-maquina"> <br><br>
                    </label> -->

                    <label for="">
                        Hostname:
                        <input class="ipt-form" type="text" name="hostname"><br><br>
                    </label>

                    <label for="">
                        Número de Série:
                        <input class="ipt-form" type="text" name="numSerie"><br><br>
                    </label>

                    <label for="">
                        Tipo Processador:
                        <input class="ipt-form" type="text" name="tipo_Processador"><br><br>
                    </label>

                    <!-- <label for="">
                        Componentes:
                        <select name="" id="" class="ipt-form" name="fkComponentes">
                            <option value="1000">CPU</option>
                            <option value="1001">Memoria-RAM</option>
                            <option value="1002">Disco</option>
                        </select><br><br>
                    </label> -->

                    <input type="text" style="display: none;" name="fkUsuario" id="fkUsuario">

                    <button class="btn-cadastrar" type="submit">Cadastrar Componentes</button>
                </form>

            </div>


        </main>
    </div>
</body>

</html>
<script>

    function cadastrar_maquina() {

        fkUsuario.value = Number(sessionStorage.getItem('id_usuario_meuapp'));
        console.log(fkUsuario.value)

        var formulario = new URLSearchParams(new FormData(form_cadastro_maquina));
        fetch("/maquinas/cadastrar", {
            method: "POST",
            body: formulario
        }).then(function (response) {

            if (response.ok) {
                console.log('Maquina cadastrada')

                // cadastrar_maquina_componentes();

            } else {

                console.log('Erro de cadastro!');
                response.text().then(function (resposta) {
                    alert(resposta);
                    // div_erro.innerHTML = resposta;
                });

            }
        });

        return false;
    }

    // function cadastrar_maquina_componentes() {

    //     var formulario = new URLSearchParams(new FormData(form_cadastro_maquina));
    //     fetch("/maquinasComponentes/cadastrar", {
    //         method: "POST",
    //         body: formulario
    //     }).then(function (response) {

    //         if (response.ok) {
    //             console.log('Maquina vinculada com o componente')

    //             // window.location.href = 'login-cadastro.html';

    //         } else {

    //             console.log('Erro de cadastro!');
    //             response.text().then(function (resposta) {
    //                 alert(resposta);
    //                 // div_erro.innerHTML = resposta;
    //             });

    //         }
    //     });

    //     return false;
    // }

</script>